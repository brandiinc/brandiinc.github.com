I"–é<h2 id="overview">Overview</h2>

<p>ë¸Œëœë””ì˜ ë¹ ë¥¸ ì„±ì¥ê³¼ í•¨ê»˜ ê´€ë¦¬ì í˜ì´ì§€ ë‚´ ì£¼ë¬¸ê³¼ ìƒí’ˆ ë“±ë¡ ê±´ìˆ˜ ë˜í•œ ê¸°í•˜ê¸‰ìˆ˜ì ìœ¼ë¡œ ì¦ê°€í•´ì™”ìŠµë‹ˆë‹¤. ë¸Œëœë”” êµ¬ì„±ì›ì˜ ì—…ë¬´ì— ê´€ë¦¬ì ë‚´ ì—‘ì…€ ë‹¤ìš´ë¡œë“œ ê¸°ëŠ¥ì´ ì‚¬ìš©ë˜ëŠ” ë§Œí¼ ë§ì€ ê±´ìˆ˜ì˜ ë°ì´í„°ë¥¼ ë¹ ë¥¸ ì‹œê°„ ë‚´ ì—‘ì…€ë¡œ ë‹¤ìš´ë¡œë“œí•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì˜ í•„ìš”ì„±ì´ ëŒ€ë‘ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ì— ìƒí’ˆ í˜¹ì€ ì£¼ë¬¸ ëª©ë¡ ëª‡ ì‹­ë§Œ ê±´ì„ ì—‘ì…€ì„ í†µí•´ ë¹ ë¥´ê²Œ ë‹¤ìš´ë¡œë“œ ê°€ëŠ¥í•˜ë„ë¡ ë§Œë“¤ì–´ ì—…ë¬´ íš¨ìœ¨ì„ ì¦ì§„ì‹œí‚¤ê³  ë¸Œëœë””ì˜ ì„±ì¥ ì†ë„ì— ë°•ì°¨ë¥¼ ê°€í•˜ê³ ì ì´ë²ˆ í”„ë¡œì íŠ¸ë¥¼ ê¸°íší•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.</p>

<p>ìš°ë¦¬ëŠ” ìˆ˜ì‹­ë§Œ ê±´ì˜ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ë©´ì„œ ë°ì´í„°ë² ì´ìŠ¤ì— ë¶€í•˜ë¥¼ ì¤„ì¼ ìˆ˜ ìˆëŠ” ë°©ì•ˆì„ ê³ ë ¤í•˜ë©° ìƒí’ˆ ê´€ë¦¬ ì´í›„, ì£¼ë¬¸ ê´€ë¦¬ë¶€í„° ì •ì‚° ê´€ë¦¬ê¹Œì§€ ë§ì€ ë©”ë‰´ íƒ­ì˜ ì—‘ì…€ ë‹¤ìš´ë¡œë“œ ê¸°ëŠ¥ì„ ê°œì„ í•´ ë‚˜ê°€ì•¼ í•˜ê¸°ì—, í•„ìš”ì— ë”°ë¼ ë©”ë‰´ ë³„ í…œí”Œë¦¿ì„ ë§Œë“¤ì–´ í•´ë‹¹ ë©”ë‰´ì˜ í…œí”Œë¦¿ì„ í†µí•´ ìš”ì²­ ê°’ì„ ê²€ì¦í•˜ê³ , ê·¸ ìš”ì²­ ê°’ì„ ì´ìš©í•˜ì—¬ ì¿¼ë¦¬ë¥¼ ëŒë ¤ ê²°ê³¼ë¥¼ ì¶”ì¶œ í•´ë‚´ë„ë¡ í•´ì•¼ í–ˆìŠµë‹ˆë‹¤.  ì•„í‚¤í…ì²˜ë¥¼ ì‚´í´ë³´ë©° ì–´ë–»ê²Œ ê°œë°œí• ì§€ ê·¸ë ¤ ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.
<br /><br /></p>

<h2 id="0-ì•„í‚¤í…ì²˜ë¥¼-í†µí•´-ë¯¸ë¦¬-ì‚´í´ë³´ê¸°">#0. ì•„í‚¤í…ì²˜ë¥¼ í†µí•´ ë¯¸ë¦¬ ì‚´í´ë³´ê¸°</h2>

<figure class="fullwidth">
  <img src="http://labs.brandi.co.kr///assets/2020/20200609/01.png" alt="excel" />
</figure>
<figcaption></figcaption>

<p>ìœ„ì²˜ëŸ¼ ëª¨ì‹ë„ë¥¼ ê·¸ë ¤ ë³´ì•˜ìŠµë‹ˆë‹¤. ë¸Œëœë”” ê´€ë¦¬ìì˜ ìƒí’ˆ ê´€ë¦¬ íƒ­ì„ ì£¼ì œë¡œ í•˜ëŠ” ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì´ìš©í•˜ì—¬ ìœ„ì˜ ëª¨ì‹ë„ë¥¼ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.</p>

<p>1) ë¸Œëœë”” ê´€ë¦¬ì í˜ì´ì§€ì—ì„œ ì—‘ì…€ ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ í´ë¦­ ì‹œ JSON í˜•ì‹ì˜ ë°ì´í„° SQS ëŒ€ê¸°ì—´ì— ë“±ë¡</p>

<p>2) SQSì—ì„œ ì•ì— ë§ˆì§€ë§‰ ìš”ì²­ì´ ëë‚¬ë‹¤ë©´ Lambda íŠ¸ë¦¬ê±° ë°œìƒ. ì´ë•Œ <strong>ë™ì‹œì„±ì´ 1</strong>ì´ë¯€ë¡œ í•œ ë²ˆì— í•˜ë‚˜ì”©ë§Œ ëŒë‹¤ë¡œ ë“¤ì–´ê°€ë„ë¡ ë˜ì–´ìˆìŒ</p>

<p>3) ëŒë‹¤ì—ì„œ SQS ë©”ì‹œì§€ì— ë“¤ì–´ìˆëŠ” templateIdë¡œ í…œí”Œë¦¿ ì½ì–´ì˜¨ ë’¤, í…œí”Œë¦¿ì— ë§¤ì¹­ë˜ì–´ìˆëŠ” sqlë„ ê°™ì´ ì½ì–´ì„œ ê°€ì ¸ì˜´</p>

<p>4) Lambda ë‚´ë¶€ì˜ ë¡œì§ì— ë”°ë¼ ìš”ì²­ ê°’ê³¼ í…œí”Œë¦¿ì„ ê²€ì¦</p>

<p>5) **ì‹œì‘ì¼ìë¶€í„° ì¢…ë£Œì¼ìê¹Œì§€ ëŠì–´ ì½ëŠ” ë‹¨ìœ„ë¡œ ì¿¼ë¦¬ë¥¼ ì‹¤í–‰ì‹œì¼œ ì—‘ì…€ íŒŒì¼ì„ ìƒì„±í•œ ë’¤, SESë¥¼ ì´ìš©í•˜ì—¬ ì—‘ì…€íŒŒì¼ì´ ì €ì¥ë˜ì–´ ìˆëŠ” URLì„ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ë°œì†¡</p>

<p>6) <strong>15ë¶„ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆëŠ” timeout ë°œìƒ ì‹œ</strong> SQS deadletterë¡œ ê¸°ì¡´ì— ë°›ì€ ë©”ì‹œì§€ë¥¼ ë³´ë‚´ê³  deadletter SQSì—ì„œ ëŒë‹¤ë¡œ ë‹¤ì‹œ íŠ¸ë¦¬ê±°ë¥¼ ë°œìƒ ì‹œí‚¤ë©´, íƒ€ì„ì•„ì›ƒ ë©”ì¼ ê·œê²©ì„ í†µí•´ ë°œì‹ ìì— ì‹¤íŒ¨ ë©”ì¼ ë°œì†¡</p>

<p>ë‹¤ìŒìœ¼ë¡œ 4ë²ˆì˜ ê²€ì¦ ë¡œì§ì— ëŒ€í•´ ì¡°ê¸ˆ ë” ìì„¸íˆ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.</p>

<figure class="percent70">
  <img src="http://labs.brandi.co.kr///assets/2020/20200609/02.png" alt="excel" />
</figure>
<figcaption></figcaption>

<p>ìš”ì²­ ê°’ê³¼ ê²€ì¦ í…œí”Œë¦¿ì˜ depthê°€ 2ì¸ í•„ë“œë“¤ì€ ë°˜ë“œì‹œ 1:1ë¡œ ë§¤ì¹­ë˜ì–´ì•¼ í•©ë‹ˆë‹¤. ìš”ì²­ ê°’ì€ ë¬´ì¡°ê±´ ê²€ì¦ ë¡œì§ì„ í†µê³¼í•´ì•¼ ì¿¼ë¦¬ì˜ íŒŒë¼ë¯¸í„°ë¡œ ë„˜ì–´ê°€ê¸° ë•Œë¬¸ì—, í…œí”Œë¦¿ì— ì„¤ì •ë˜ì–´ ìˆì§€ ì•Šì€ íŒŒë¼ë¯¸í„°ëŠ” ê²€ì¦ì´ ë˜ì§€ ì•Šì€ ê²ƒìœ¼ë¡œ íŒë‹¨ë˜ì–´ ì¿¼ë¦¬ì˜ ì¸ìë¡œ ë“¤ì–´ê°€ì§€ ì•Šë„ë¡ ì„¤ê³„ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì´ë²ˆ í”„ë¡œì íŠ¸ì—ì„œ í•˜ë£¨ ë‹¨ìœ„ë¡œ ëŠì–´ ì¿¼ë¦¬ë¥¼ ì‹¤í–‰ì‹œì¼œ ë°ì´í„° íŒŒì¼ì„ ë§Œë“¤ê¸°ë¡œ í–ˆìœ¼ë¯€ë¡œ, ì˜ëª»ëœ ìš”ì²­ ê°’ì´ ì¿¼ë¦¬ì˜ ì¸ìë¡œ ì „ë‹¬ëœë‹¤ë©´ 90ì¼ì¹˜ì˜ ì¡°íšŒ ì‹œ 90ë²ˆì˜ ì¿¼ë¦¬ë¥¼ ë‚ ë ¤ ì˜ëª»ëœ 90ê°œì˜ ë°ì´í„° íŒŒì¼ì„ ìƒì„±í•˜ê²Œ ë˜ë¯€ë¡œ ê²€ì¦ì„ ë§¤ìš° ì² ì €í•˜ê²Œ í•´ì•¼ í•©ë‹ˆë‹¤.
<br /><br /></p>

<h2 id="1-ìš”ì²­ê°’ì—-ë”°ë¼-í…œí”Œë¦¿-ì„¤ì •í•˜ê¸°">#1. ìš”ì²­ê°’ì— ë”°ë¼ í…œí”Œë¦¿ ì„¤ì •í•˜ê¸°</h2>

<p><strong>0-1ë²ˆ</strong>ì˜ ì—‘ì…€ ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ì„ í´ë¦­í•˜ê²Œ ë˜ë©´ SQSë¡œ ë©”ì‹œì§€ë¥¼ ë“±ë¡í•˜ê²Œ ë©ë‹ˆë‹¤. ìƒí’ˆ ê´€ë¦¬ í˜ì´ì§€ì˜ í•„í„° ì¡°ê±´ì„ ì´ìš©í–ˆì„ ì‹œì—ëŠ” ë‹¤ìŒê³¼ ê°™ì€ JSON ê°’ì´ SQS ìš”ì²­ ê·œê²©ì— ì•Œë§ê²Œ ë³€í˜•ë˜ì–´ ëŒë‹¤ë¡œ í˜ëŸ¬ ë“¤ì–´ê°€ê²Œ ë©ë‹ˆë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "templateId":"*****ProductList",# ê²€ì¦ì„ ìœ„í•´ ì‚¬ìš©í•  ë²„í‚·ì— ì €ì¥ëœ í…œí”Œë¦¿
  "downloadTitle":"",                 # ë‹¤ìš´ë¡œë“œ ì‹œ ì§€ì •ë  ë‹¤ìš´ë¡œë“œ íŒŒì¼ëª…
  "requestInfo": {
    "name":false,                     # ìš”ì²­ìì˜ ì´ë¦„
    "email":"p*****n@brandi.co.kr",   # ìš”ì²­ìì˜ ì´ë©”ì¼ ì£¼ì†Œ
    "mdId":"p*****@brandi.co.kr",     # ìš”ì²­ìì˜ ID ì£¼ì†Œ
    "serviceSection":"ë¸Œëœë””",          # ìš”ì²­ì„œë¹„ìŠ¤ ë¸Œëœë””/í•˜ì´ë²„
    "accountNo":"*****",              # ê³„ì • ë²ˆí˜¸
    "mdNo":false.                     # ì…€ëŸ¬ ë²ˆí˜¸ ( ê´€ë¦¬ì ê³„ì •ì€ false )
    },
  "parameter": {
    "templateId":"*****ProductList",       # ê²€ì¦ì„ ìœ„í•´ ì‚¬ìš©í•  ë²„í‚·ì— ì €ì¥ëœ í…œí”Œë¦¿
    "filter": {
      "mdSeNo":["1","2","3","4","5","6","7"],  # ì…€ëŸ¬ ì†ì„±
      "mdPartnerYn": "Y",                       # ì…€ëŸ¬ êµ¬ë¶„
      "useYn":"Y",                              # ìƒí’ˆ ë“±ë¡ ì—¬ë¶€
      "sellYn":"Y",                             # ìƒí’ˆ íŒë§¤ ì—¬ë¶€
      "exhibitionYn":"Y",                       # ìƒí’ˆ ì „ì‹œ ì—¬ë¶€
      "mdPrtnrNo":1,                            # ì…€ëŸ¬ êµ¬ë¶„ ë²ˆí˜¸
      "productName":"ì…”ì¸ ",                      # ìƒí’ˆëª…
      "registDate":{
        "startDate":"2020-05-01",               # ì¡°íšŒ ê¸°ê°„ ì‹œì‘ì¼
        "endDate":"2020-05-03"                  # ì¡°íšŒ ê¸°ê°„ ë§ˆê°ì¼
      },
      "serviceSectionNo":"1",                   # ë¸Œëœë””/í•˜ì´ë²„ ì„œë¹„ìŠ¤ êµ¬ë¶„
      "_matchProductName":"+ì…”ì¸ ",               # FullText ì„œì¹˜ë¥¼ ìœ„í•œ ìƒí’ˆëª… ì •ê·œì‹í™”
      "isMaster":"Y"                            # ì…€ëŸ¬/ê´€ë¦¬ì êµ¬ë¶„ì
    }
  }
}
</code></pre></div></div>

<p>S3ì— ì €ì¥ëœ ì¿¼ë¦¬ëŠ” Jinja2 í…œí”Œë¦¿ì„ ì´ìš©í•˜ì—¬ ìš”ì²­ ê°’ì— ê°’ì´ ë“¤ì–´ ìˆë‹¤ë©´ ì¿¼ë¦¬ ë‚´ì—ì„œ ë¶„ê¸°í•˜ì—¬ í•„í„°ë¥¼ ê±°ì³ê°€ë„ë¡ ì•„ë˜ì™€ ê°™ì´ ì‘ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì•„ë˜ì˜ ì¿¼ë¦¬ëŠ” ì„¤ëª…ì„ ìœ„í•´ ì¿¼ë¦¬ë¥¼ ì¼ë¶€ ë°œì·Œí•˜ì—¬ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤. ì—¬ê¸°ì„œ ìš”ì²­ ê°’ì˜ requestInfoëŠ” í”„ë¡ íŠ¸ ë‹¨ì—ì„œ ì¡°ê±´ì— ë”°ë¼ ê²€ì¦í•´ ì¤„ ê²ƒì´ë©°, ê²€ì¦ ë¡œì§ì—ì„œëŠ” ì¿¼ë¦¬ì— ë“¤ì–´ê°€ê²Œ ë  parameter ë¶€ë¶„ì„ ì£¼ìš”í•˜ê²Œ ê²€ì¦í•  ê²ƒì…ë‹ˆë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{% if filter._matchProductName and filter.productName %}
-- _matchProductNameì€ PHPì—ì„œ ë§ì•„ì¤€ ìƒí’ˆëª…ì˜ ì •ê·œì‹ ( MySQL ì •ê·œì‹ ë¯¸ì§€ì› )
-- FullText ì„œì¹˜ì—ì„œ ì‚¬ìš©í•˜ê¸° ìœ„í•´ PHP ì—ì„œ ë³´ë‚´ ì¤Œ.
AND MATCH(ìƒí’ˆëª… ì¹¼ëŸ¼) AGAINST (%(filter._matchProductName)s IN BOOLEAN MODE)
AND (ìƒí’ˆëª… ì¹¼ëŸ¼) LIKE CONCAT('%%', %(filter.productName)s, '%%')
{% endif %}
{% if filter.productNo %}
AND (ìƒí’ˆ ë“±ë¡ë²ˆí˜¸ ì¹¼ëŸ¼) = %(filter.productNo)s
{% endif %}
AND (ìƒí’ˆ ë“±ë¡ì¼ì ì¹¼ëŸ¼) &gt;= %(filter.registDate.startDate)s
AND (ìƒí’ˆ ë“±ë¡ì¼ì ì¹¼ëŸ¼) &lt; %(filter.registDate.endDate)s
</code></pre></div></div>

<p>#2ì—ì„œ ë‹¤ì‹œ ì–¸ê¸‰í•˜ê² ì§€ë§Œ, ìš”ì²­ ê°’ì— ë“±ë¡ ì¼ìëŠ” í•„ìˆ˜ ê°’ì´ê¸°ì— ì¡°ê±´ì´ ì—†ìŠµë‹ˆë‹¤. ìƒí’ˆëª…ê³¼ ìƒí’ˆ ë²ˆí˜¸ëŠ” í•„ìˆ˜ ê°’ì´ ì•„ë‹ˆê¸°ì— ê²€ìƒ‰ í•„í„°ë¥¼ í†µí•´ ê²€ìƒ‰ëœ ë¦¬ìŠ¤íŠ¸ì— í•œí•´ ê°’ì´ ë“¤ì–´ìˆë‹¤ë©´ ì¿¼ë¦¬ì˜ ì¡°ê±´ë¬¸ìœ¼ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤.
<br /><br /></p>

<h2 id="2-í…œí”Œë¦¿ì„-í†µí•´-ê²€ì¦í•˜ê¸°">#2. í…œí”Œë¦¿ì„ í†µí•´ ê²€ì¦í•˜ê¸°</h2>

<p>ê·¸ë ‡ë‹¤ë©´ ìœ„ì˜ ìš”ì²­ ê°’ì„ ê²€ì¦í•  í…œí”Œë¦¿ì„ ë§Œë“¤ì–´ì•¼ í•©ë‹ˆë‹¤. í…œí”Œë¦¿ì€ ì¶”í›„ ìƒí’ˆ ê´€ë¦¬ íƒ­ ì´ì™¸ì— ì£¼ë¬¸ ê´€ë¦¬, ì •ì‚° ê´€ë¦¬ ë“± ë‹¤ì–‘í•œ íƒ­ì˜ í…œí”Œë¦¿ì„ ì œì‘í•˜ì—¬ ê°ˆì•„ ë¼ìš°ê¸°ë§Œ í•˜ë©´ ëŒ€ìš©ëŸ‰ ì—‘ì…€ ë‹¤ìš´ë¡œë“œê°€ ê°€ëŠ¥í•˜ë„ë¡ ê¸°ëŠ¥í•´ì•¼ í•˜ê¸°ì— ì„¤ê³„ ë‹¨ê³„ì—ì„œ ë§¤ìš° ê³ ì‹¬í•´ì„œ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>createDate:2020-05-24
version:2
templateName:"ìƒí’ˆê´€ë¦¬_*****_ì—‘ì…€ë‹¤ìš´ë¡œë“œ_{%Y%m%d}"#downloadNameë¯¸ì§€ì •ì‹œëŒ€ì²´
description:ìƒí’ˆëŒ€ìš©ëŸ‰ë‹¤ìš´ë¡œë“œì…ë‹ˆë‹¤.
queryFile:***** admin_product_list.sql # ì‚¬ìš©í•  ì¿¼ë¦¬íŒŒì¼
options:
    exportFormat:xlsx#ë‚´ë³´ë‚´ê¸°í¬ë§·ì…ë‹ˆë‹¤.
    reservedService:***** # ë‹¤ìš´ë¡œë“œì‹œì‚¬ìš©í•˜ëŠ”í¬ë§·.ë¯¸ì§€ì •ì‹œëŒ€ì²´
requestInfo:
    emailAddress:
        sender:labs-brandi@brandi.co.kr
        type:string
        required:true
    downloadStep:
        required:true
        type:date #date,datetime
    stepRange: # ì‹œì‘ì¼ë¡œë¶€í„° ëŠì–´ ì½ê¸° ë‹¨ìœ„
        days:1
        target:
            -filter.registDate.startDate
            -filter.registDate.endDate
validation:
    filter.mdSeNo:
        name:ì…€ëŸ¬ì†ì„±
        type:array
        required:true
    filter.registDate.startDate:
        name:ì‹œì‘ì¼ì‹œ
        required:true
        type:date            #format:YYYY-mm-dd#2020-04-12#ë‚ ì§œí¬ë§·
    filter.registDate.endDate:
        name:ì¢…ë£Œì¼ì‹œ
        required:true
        type:date
    dateDiff:
        target:filter.registDate.startDate
        maxRange:            # ìµœëŒ€ ë‹¤ìš´ë¡œë“œ ê°€ëŠ¥ ê¸°ê°„
            days:92          # 3ê°œì›”ì˜ maxRangeì„¤ì •
            hours:0
            minutes:0
            seconds:0
    filter.mdPartnerYn:
        name:íŒŒíŠ¸ë„ˆì—¬ë¶€
        required:false
    filter.mdName:
        name:ì…€ëŸ¬ëª…
        required:false
        maxLength:20
        minLength:1
    filter.productName:
        name:ìƒí’ˆëª…
        max:200
        min:10
    filter.productCode:
        name:ìƒí’ˆì½”ë“œ
        required:false
    filter.productNo:
        name:ìƒí’ˆë²ˆí˜¸
        required:false
    filter.useYn:
        name:ë“±ë¡ì—¬ë¶€
        required:false
    filter.discountYn:
        name:í• ì¸ì—¬ë¶€
        required:false
    filter.sellYn:
        name:íŒë§¤ì—¬ë¶€
        required:false
    filter.exhibitionYn:
        name:ì§„ì—´ì—¬ë¶€
        required:false
    filter.whsalStatus:
        name:ë„ë§¤ì²˜ìƒíƒœ
        required:false
    filter.mdPrtnrNo:
        name:ì…€ëŸ¬êµ¬ë¶„
        required:false
    filter.todayInventoryYn:
        name:ë°°ì†¡êµ¬ë¶„
        required:false
    filter.mdNo:
        name:ì…€ëŸ¬ë²ˆí˜¸
        required:false
    filter.recommendPriceCd:
        name:ê¶Œì¥ê°€ê²©
        required:false
    filter.serviceSectionNo:
        name:ì„œë¹„ìŠ¤êµ¬ë¶„
        required:true
    filter.isMaster:
        name:ë§ˆìŠ¤í„°êµ¬ë¶„
        required:false
    filter._matchProductName:
        name:ìƒí’ˆëª…ì •ê·œì‹
        required:false
    filter.isHelpi:
        name:ì…€ëŸ¬êµ¬ë¶„
        required:false
</code></pre></div></div>

<p>ì—¬ê¸°ì„œ ëª‡ ê°€ì§€ í•„ë“œë“¤ì„ ê²€ì¦í•˜ëŠ” ê²€ì¦ ë¡œì§ì˜ ì½”ë“œë¥¼ ë°œì·Œí•˜ì—¬ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ì½”ë“œ ì¼ë¶€ ë°œì·Œ
</span>
<span class="n">config</span><span class="p">[</span><span class="s">'requestInfo'</span><span class="p">]</span> <span class="o">=</span> <span class="n">template_data</span><span class="p">[</span><span class="s">'requestInfo'</span><span class="p">]</span> <span class="c1"># í…œí”Œë¦¿ì˜ requestInfoë¶€ë¶„
</span><span class="n">request_info</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s">'requestInfo'</span><span class="p">]</span>
<span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">search</span><span class="p">(</span><span class="s">'^[a-zA-Z0-9+-_.]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+$'</span><span class="p">,</span>
                   <span class="n">request_info</span><span class="p">[</span><span class="s">'emailAddress'</span><span class="p">][</span><span class="s">'sender'</span><span class="p">])</span>
<span class="k">if</span> <span class="n">match</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
    <span class="k">raise</span> <span class="n">ApiException</span><span class="p">(</span><span class="s">'VL00003'</span><span class="p">,</span> <span class="s">'ë°œì‹  ë©”ì¼ì´ ì´ë©”ì¼ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤.'</span><span class="p">)</span>
</code></pre></div></div>

<p>ì´ ë¶€ë¶„ì€ ì •ê·œì‹ì„ ì´ìš©í•˜ì—¬, ë°œì‹ ìì˜ ì´ë©”ì¼ ì£¼ì†Œê°€ ì˜ëª» ì„¤ì •ë˜ëŠ” ê²ƒì„ ë¯¸ì—°ì— ë°©ì§€í•˜ê¸° ìœ„í•¨ì…ë‹ˆë‹¤. ìš”ì²­ìì—ê²Œ ë©”ì¼ì„ ë³´ë‚´ì£¼ëŠ” ë°œì‹ ìì˜ ì´ë©”ì¼ ì£¼ì†Œì— ì˜ëª»ëœ ì´ë©”ì¼ ì£¼ì†Œê°€ ê¸°ì…ë˜ëŠ” ê²ƒì„ ë°©ì§€í•˜ëŠ” ê²ƒìœ¼ë¡œ, í…œí”Œë¦¿ì˜ ì˜¤ë¥˜ ë©”ì‹œì§€ëŠ” í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ë…¸ì¶œë˜ì§€ ì•Šê³  ì‹¤í–‰ ì‹œ ê°œë°œìì—ê²Œ ë…¸ì¶œë©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ì½”ë“œ ì¼ë¶€ ë°œì·Œ
</span>
<span class="k">if</span> <span class="s">'stepRange'</span> <span class="ow">in</span> <span class="n">request_info</span><span class="p">[</span><span class="s">'downloadStep'</span><span class="p">]:</span>
    <span class="c1"># ëŠì–´ì„œ ì €ì¥í•˜ëŠ” ë²”ìœ„ê°€ ìˆëŠ”ì§€ í™•ì¸
</span>    <span class="n">step_range</span> <span class="o">=</span> <span class="n">request_info</span><span class="p">[</span><span class="s">'downloadStep'</span><span class="p">][</span><span class="s">'stepRange'</span><span class="p">]</span>
    <span class="c1"># í…œí”Œë¦¿ ë‚´ ì‹œê°„ ë²”ìœ„ê°€ ì˜ëª» ì„¤ì •ëœ ê²½ìš° ë°œìƒ
</span>    <span class="k">if</span> <span class="s">'days'</span> <span class="ow">in</span> <span class="n">step_range</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">step_range</span><span class="p">[</span><span class="s">'days'</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ApiException</span><span class="p">(</span><span class="s">'VL00002'</span><span class="p">,</span> <span class="s">'ë‹¤ìš´ë¡œë“œ ìœ íš¨ê¸°ê°„ ì¼ì ì„¤ì •ì´ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤.'</span><span class="p">)</span>
    <span class="k">elif</span> <span class="s">'hours'</span> <span class="ow">in</span> <span class="n">step_range</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">step_range</span><span class="p">[</span><span class="s">'hours'</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">24</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">ApiException</span><span class="p">(</span><span class="s">'VL00002'</span><span class="p">,</span> <span class="s">'ë‹¤ìš´ë¡œë“œ ìœ íš¨ê¸°ê°„ ì‹œê°„ ì„¤ì •ì´ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤.'</span><span class="p">)</span>
    <span class="k">elif</span> <span class="s">'minutes'</span> <span class="ow">in</span> <span class="n">step_range</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">step_range</span><span class="p">[</span><span class="s">'minutes'</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">60</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">ApiException</span><span class="p">(</span><span class="s">'VL00002'</span><span class="p">,</span> <span class="s">'ë‹¤ìš´ë¡œë“œ ìœ íš¨ê¸°ê°„ ë¶„ ì„¤ì •ì´ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤.'</span><span class="p">)</span>
    <span class="k">elif</span> <span class="s">'seconds'</span> <span class="ow">in</span> <span class="n">step_range</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">step_range</span><span class="p">[</span><span class="s">'seconds'</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">60</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">ApiException</span><span class="p">(</span><span class="s">'VL00002'</span><span class="p">,</span> <span class="s">'ë‹¤ìš´ë¡œë“œ ìœ íš¨ê¸°ê°„ ì´ˆ ì„¤ì •ì´ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤.'</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ApiException</span><span class="p">(</span><span class="s">'VL00001'</span><span class="p">,</span> <span class="s">'ë‹¤ìš´ë¡œë“œ ìœ íš¨ê¸°ê°„ ë‚´ ê¸°ê°„ ì„¤ì •ì´ ë˜ì–´ìˆì§€ ì•ŠìŠµë‹ˆë‹¤.'</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">raise</span> <span class="n">ApiException</span><span class="p">(</span><span class="s">'VL00001'</span><span class="p">,</span> <span class="s">'ë‹¤ìš´ë¡œë“œ ê°€ëŠ¥í•œ ìœ íš¨ê¸°ê°„ì´ ì„¤ì •ë˜ì–´ìˆì§€ ì•ŠìŠµë‹ˆë‹¤.'</span><span class="p">)</span>
</code></pre></div></div>

<p>ìš°ë¦¬ëŠ” ì‹œì‘ ì¼ìë¡œë¶€í„° ë§ˆê° ì¼ìê¹Œì§€ í•˜ë£¨ ë‹¨ìœ„ë¡œ ëŠì–´ ì½ë„ë¡ í…œí”Œë¦¿ì— ì„¤ì •í•˜ì˜€ìŠµë‹ˆë‹¤. í…œí”Œë¦¿ì˜ ì‹œê°„ ë²”ì£¼ë¥¼ ëª…í™•í•˜ê²Œ í•˜ì—¬ ì¿¼ë¦¬ì— ì˜ëª»ëœ datetime í˜•ì‹ìœ¼ë¡œ íŒŒë¼ë¯¸í„°ê°€ ë„˜ì–´ê°€ì§€ ì•Šë„ë¡ í•˜ê¸° ìœ„í•˜ì—¬ ìœ„ì™€ ê°™ì´ ëŠì–´ ì½ëŠ” ë‹¨ìœ„ë¥¼ ê²€ì¦í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ì½”ë“œ ì¼ë¶€ ë°œì·Œ
</span>
<span class="n">config</span><span class="p">[</span><span class="s">'validation'</span><span class="p">]</span> <span class="o">=</span> <span class="n">template_data</span><span class="p">[</span><span class="s">'validation'</span><span class="p">]</span> <span class="c1"># í…œí”Œë¦¿ì˜ ê²€ì¦ ë¶€ë¶„
</span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">config</span><span class="p">[</span><span class="s">'validation'</span><span class="p">]:</span>
    <span class="n">column</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s">'validation'</span><span class="p">][</span><span class="n">key</span><span class="p">]</span>
    <span class="n">validation_keys</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s">'validation'</span><span class="p">].</span><span class="n">keys</span><span class="p">()</span>
    <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">get_json_param</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="n">plain_param</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">__json_to_plan_dict</span><span class="p">(</span><span class="n">parameter</span><span class="p">)</span>
    <span class="k">if</span> <span class="s">'required'</span> <span class="ow">in</span> <span class="n">column</span> <span class="ow">and</span> <span class="n">column</span><span class="p">[</span><span class="s">'required'</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ApiException</span><span class="p">(</span><span class="s">'VL00001'</span><span class="p">,</span> <span class="s">'í•„ìˆ˜ ì¹¼ëŸ¼ì¸ '</span> <span class="o">+</span> <span class="n">column</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'name'</span><span class="p">)</span><span class="o">+</span><span class="s">' ê°’ì´ ëˆ„ë½ë˜ì—ˆìŠµë‹ˆë‹¤.'</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">val</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">continue</span>
</code></pre></div></div>

<p>í…œí”Œë¦¿ì˜ ê²€ì¦ ë¶€ë¶„ì— ìˆëŠ” ê°’ë“¤ ì¤‘ <strong>required: true</strong> ë¡œ ë˜ì–´ìˆëŠ” ë¶€ë¶„ì´ ìš”ì²­ ê°’ìœ¼ë¡œ ë“¤ì–´ì˜¤ì§€ ì•Šì•˜ë‹¤ë©´ ì—ëŸ¬ë¥¼ ì¼ìœ¼í‚¤ê²Œ ë©ë‹ˆë‹¤. í•„ìˆ˜ ê°’ì¸ ë¶€ë¶„ì€ í”„ë¡ íŠ¸ ë‹¨ì—ì„œ 1ì°¨ì ìœ¼ë¡œ ê²€ìˆ˜í•˜ì—¬ ì…ë ¥ì´ ë˜ì§€ ì•ŠëŠ” ë‹¤ë©´ alert í™”ë©´ì´ ë…¸ì¶œë˜ì§€ë§Œ, í˜¹ì‹œ ëª¨ë¥¼ ìƒí™©ì„ ëŒ€ë¹„í•˜ì—¬ ë°±ì—”ë“œ ë‹¨ì—ì„œë„ 2ì°¨ì ìœ¼ë¡œ í•„ìˆ˜ ê°’ì— ëŒ€í•˜ì—¬ ê²€ì¦í•´ ì£¼ì—ˆìŠµë‹ˆë‹¤.</p>

<p>ìœ„ì™€ ê°™ì€ ê²€ì¦ ë¡œì§ì„ ê±°ì¹˜ê³  ë‚˜ë©´ ìš”ì²­ ê°’ì— ë“¤ì–´ìˆëŠ” ì¸ìë“¤ì˜ JSON depthê°€ ëª¨ë‘ ê°™ë„ë¡ ìª¼ê°  ë‹¤ìŒ parameterë¡œ ë¬¶ì–´ì„œ ê²€ì¦ ë¡œì§ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•œ ë¶€ë¶„ì— ë°˜í™˜í•´ ì¤ë‹ˆë‹¤.
<br /><br /></p>

<h2 id="3-ë¶„ë¦¬ëœ-íŒŒì¼ë“¤-mergeí•˜ì—¬-ì—‘ì…€-íŒŒì¼-ë§Œë“¤ê¸°">#3. ë¶„ë¦¬ëœ íŒŒì¼ë“¤ mergeí•˜ì—¬ ì—‘ì…€ íŒŒì¼ ë§Œë“¤ê¸°</h2>

<p>ìœ„ì˜ íŒŒë¼ë¯¸í„°ê°€ ì¿¼ë¦¬ë¡œ ë„˜ì–´ì™€ì„œ ì¿¼ë¦¬ê°€ ì‹¤í–‰ë˜ë©´ ì¼ìë³„ë¡œ í•˜ì—¬ data[00N].data ì™€ ê°™ì€ ë¦¬ìŠ¤íŠ¸ íŒŒì¼ê³¼ ì»¬ëŸ¼ ê°’ì´ ë“¤ì–´ìˆëŠ” header.data íŒŒì¼ì´ ìƒì„±ë©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ì½”ë“œ ì¼ë¶€ ë°œì·Œ
</span>
<span class="c1"># í—¤ë” ë°ì´í„° ì‘ì„±
</span><span class="k">if</span> <span class="n">is_header_write</span> <span class="ow">is</span> <span class="bp">False</span> <span class="ow">and</span> <span class="n">query_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">query_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">header_list</span> <span class="o">=</span> <span class="n">query_list</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">keys</span><span class="p">()</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">folder_name</span> <span class="o">+</span> <span class="s">'/header.data'</span><span class="p">,</span> <span class="s">'wt'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">"utf-8"</span><span class="p">)</span> <span class="k">as</span> <span class="n">w</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">header_list</span><span class="p">:</span>
            <span class="n">w</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="n">w</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">"</span><span class="se">\t</span><span class="s">"</span><span class="p">)</span>
    <span class="n">is_header_write</span> <span class="o">=</span> <span class="bp">True</span>

<span class="c1"># ê²°ê³¼ ë¦¬ìŠ¤íŠ¸ ìƒì„±
</span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">folder_name</span> <span class="o">+</span> <span class="s">'/data'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">zfill</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="s">'.data'</span><span class="p">,</span> <span class="s">"w"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">query_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">query_list</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">item</span><span class="p">.</span><span class="n">values</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                    <span class="k">if</span> <span class="s">'</span><span class="se">\t</span><span class="s">'</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
                        <span class="c1"># ìƒí’ˆëª…ì— íƒ­ì´ ë“¤ì–´ê°€ëŠ” ê²½ìš° íƒ­ ì œê±°
</span>                        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">'</span><span class="se">\t</span><span class="s">'</span><span class="p">,</span> <span class="s">' '</span><span class="p">)</span>
                <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
                <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">"</span><span class="se">\t</span><span class="s">"</span><span class="p">)</span>
            <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">pass</span>
</code></pre></div></div>

<p>3ì¼ì¹˜ë¥¼ ì¡°íšŒí•˜ëŠ” ê²½ìš°ì˜ ì‹¤í–‰ ê²°ê³¼ëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.</p>

<figure class="percent40">
  <img src="http://labs.brandi.co.kr///assets/2020/20200609/03.png" alt="excel" />
</figure>
<figcaption></figcaption>

<p>ì´ë ‡ê²Œ íŒŒì¼ë“¤ì´ ìƒì„±ë˜ë©´ ë‹¤ìŒì˜ ì ˆì°¨ë¥¼ í†µí•´ ì—‘ì…€ì„ ìƒì„± í›„ S3 ë²„í‚·ì— ì—…ë¡œë“œí•©ë‹ˆë‹¤.</p>

<p>1) Lambdaì˜ tmp í´ë”ì— ë“¤ì–´ìˆëŠ” ê°ê°ì˜ íŒŒì¼ë“¤ì„ mergeí•˜ì—¬ tmp í´ë”ì— ì—‘ì…€ íŒŒì¼ ìƒì„±</p>

<p>2) ì—‘ì…€ íŒŒì¼ì„ ì œì™¸í•œ ëª¨ë“  íŒŒì¼ë“¤ì„ ì‚­ì œ</p>

<p>í…œí”Œë¦¿ íŒŒì¼ì˜ exportFormatì„ ì§€ì •í•˜ë©´ csvì™€ xlsx í¬ë§· ì¤‘ íƒí•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<hr />

<ul>
  <li>
    <p>CSV ì¥ì  :: ì½¤ë§ˆ(,) ë“±ìœ¼ë¡œ êµ¬ë¶„í•˜ì—¬ í…ìŠ¤íŠ¸ í¸ì§‘ê¸°ë¡œ ì—´ì–´ë³¼ ìˆ˜ ìˆëŠ” ë‹¨ìˆœ ì½ê¸° ì“°ê¸° í˜•ì‹ì„ ì œê³µ</p>
  </li>
  <li>
    <p>CSV ë‹¨ì  :: ì„œì‹ ì§€ì • ë“±ì´ ì–´ë µë‹¤ëŠ” ë‹¨ì ì´ ìˆì–´ ì—…ë¬´ ì¤‘ì— í¸ì§‘ ë“±ì´ ì–´ë µë‹¤ëŠ” í° ë‹¨ì ì´ ì¡´ì¬</p>
  </li>
</ul>

<hr />

<ul>
  <li>
    <p>XLSX ì¥ì  :: ì•ì˜ CSVì˜ ë‹¨ì ì„ ì»¤ë²„í•˜ì—¬ ì„œì‹ ì§€ì •ì´ ê°€ëŠ¥</p>
  </li>
  <li>
    <p>XLSX ë‹¨ì  :: ì¼ë°˜ í…ìŠ¤íŠ¸ê°€ ì•„ë‹ˆê¸°ì— dataë¥¼ mergeí•˜ì—¬ ì—‘ì…€ë¡œ ë§ˆëŠ”ë° csvì— ë¹„í•´ ì‹œê°„ì´ ì˜¤ë˜ ê±¸ë¦°ë‹¤ëŠ” ë‹¨ì </p>
  </li>
</ul>

<hr />

<p>ìƒì„± ìš©ëŸ‰ ë“± ê°ê°ì˜ ì¥ë‹¨ì ì„ ê³ ë ¤í•˜ì—¬ í•˜ë‚˜ë¥¼ íƒí•˜ì—¬ í¬ë§·ì— ì§€ì •í•˜ë©´ ë‹¤ìŒì˜ í—¬í¼ì—ì„œ ë©”ì†Œë“œë¥¼ ì‹¤í–‰í•˜ì—¬ ì—‘ì…€ íŒŒì¼ì„ ìƒì„±í•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="c1"># ì½”ë“œ ì¼ë¶€ ë°œì·Œ
</span><span class="k">class</span> <span class="nc">MassiveHelper</span><span class="p">:</span>
    <span class="s">"""ëŒ€ìš©ëŸ‰ ì²˜ë¦¬ í—¬í¼
    """</span>

    <span class="k">def</span> <span class="nf">merge_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folder_name</span><span class="p">,</span> <span class="n">output_format</span><span class="p">,</span> <span class="n">template_name</span><span class="p">):</span>
        <span class="s">"""ë¶„ë¦¬ ë˜ì–´ìˆëŠ” ë°ì´í„° csvë¡œ ë¨¸ì§•

        :param folder_name:
        :param output_format:
        :return int:
        """</span>
        <span class="n">file_list</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="p">.</span><span class="n">glob</span><span class="p">(</span><span class="n">folder_name</span> <span class="o">+</span> <span class="s">'/data*'</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">getctime</span><span class="p">)</span>
        <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">folder_name</span> <span class="o">+</span> <span class="s">'/'</span> <span class="o">+</span> <span class="n">template_name</span> <span class="o">+</span> <span class="s">'.'</span> <span class="o">+</span> <span class="n">output_format</span><span class="p">,</span> <span class="s">'wt'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">'utf-8'</span><span class="p">)</span> <span class="k">as</span> <span class="n">w</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">folder_name</span> <span class="o">+</span> <span class="s">'/header.data'</span><span class="p">,</span> <span class="s">'rt'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">"utf-8"</span><span class="p">)</span> <span class="k">as</span> <span class="n">r</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">total</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">w</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">readline</span><span class="p">())</span>
                    <span class="n">w</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">file_name</span> <span class="ow">in</span> <span class="n">file_list</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">file_name</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'data'</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s">'rt'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">'utf-8'</span><span class="p">)</span> <span class="k">as</span> <span class="n">rf</span><span class="p">:</span>
                    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
                        <span class="n">line</span> <span class="o">=</span> <span class="n">rf</span><span class="p">.</span><span class="n">readline</span><span class="p">()</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">:</span>
                            <span class="k">break</span>
                        <span class="n">w</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                        <span class="n">total</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">merge_xlsx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folder_name</span><span class="p">,</span> <span class="n">output_format</span><span class="p">,</span> <span class="n">template_name</span><span class="p">):</span>
        <span class="s">"""ë¶„ë¦¬ ë˜ì–´ìˆëŠ” ë°ì´í„° xlsxë¡œ ë¨¸ì§•

        :param folder_name:
        :param output_format:
        :return int:
        """</span>
        <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">file_list</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="p">.</span><span class="n">glob</span><span class="p">(</span><span class="n">folder_name</span> <span class="o">+</span> <span class="s">'/data*'</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">getctime</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">folder_name</span> <span class="o">+</span> <span class="s">'/'</span> <span class="o">+</span> <span class="n">template_name</span> <span class="o">+</span> <span class="s">'.'</span> <span class="o">+</span> <span class="n">output_format</span><span class="p">,</span> <span class="s">'wb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">fout</span><span class="p">:</span>
            <span class="n">writer</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="n">fout</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s">'xlsxwriter'</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">constant_memory</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">in_memory</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>

            <span class="c1"># taken from the original question
</span>            <span class="n">workbook</span> <span class="o">=</span> <span class="n">writer</span><span class="p">.</span><span class="n">book</span>
            <span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="p">.</span><span class="n">add_worksheet</span><span class="p">()</span>
            <span class="n">header_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="p">.</span><span class="n">add_format</span><span class="p">(</span>
                <span class="p">{</span><span class="s">'bold'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s">'align'</span><span class="p">:</span> <span class="s">'center'</span><span class="p">,</span> <span class="s">'valign'</span><span class="p">:</span> <span class="s">'vcenter'</span><span class="p">,</span> <span class="s">'fg_color'</span><span class="p">:</span> <span class="s">'#D7E4BC'</span><span class="p">})</span>

            <span class="n">cell_widths</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># ì…€ ë„ˆë¹„
</span>            <span class="n">font_width</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># ê¸€ì ë„ˆë¹„
</span>            <span class="n">font_width_h</span> <span class="o">=</span> <span class="mf">1.88</span>  <span class="c1"># í•œê¸€ í•œê¸€ì
</span>            <span class="n">padding</span> <span class="o">=</span> <span class="mf">1.12</span>
            <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="c1"># header write
</span>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">folder_name</span> <span class="o">+</span> <span class="s">'/header.data'</span><span class="p">,</span> <span class="s">'rt'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">"utf-8"</span><span class="p">)</span> <span class="k">as</span> <span class="n">rf</span><span class="p">:</span>
                <span class="n">datas</span> <span class="o">=</span> <span class="n">rf</span><span class="p">.</span><span class="n">readline</span><span class="p">().</span><span class="n">strip</span><span class="p">().</span><span class="n">split</span><span class="p">(</span><span class="s">'</span><span class="se">\t</span><span class="s">'</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">datas</span><span class="p">):</span>
                    <span class="n">text_cnt</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">__count_text_size</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
                    <span class="n">cell_widths</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">text_cnt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">font_width_h</span> <span class="o">+</span> <span class="n">text_cnt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">font_width</span> <span class="o">+</span> <span class="n">padding</span><span class="p">)</span>
                    <span class="n">worksheet</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">header_format</span><span class="p">)</span>

            <span class="n">y</span> <span class="o">=</span> <span class="mi">1</span>

            <span class="k">for</span> <span class="n">file_name</span> <span class="ow">in</span> <span class="n">file_list</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">file_name</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'data'</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s">'rt'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">"utf-8"</span><span class="p">)</span> <span class="k">as</span> <span class="n">rf</span><span class="p">:</span>
                    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
                        <span class="n">line</span> <span class="o">=</span> <span class="n">rf</span><span class="p">.</span><span class="n">readline</span><span class="p">()</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">:</span>
                            <span class="k">break</span>
                        <span class="n">datas</span> <span class="o">=</span> <span class="n">line</span><span class="p">.</span><span class="n">strip</span><span class="p">().</span><span class="n">split</span><span class="p">(</span><span class="s">'</span><span class="se">\t</span><span class="s">'</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">datas</span><span class="p">):</span>
                            <span class="n">worksheet</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>

                            <span class="n">text_cnt</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">__count_text_size</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
                            <span class="n">width</span> <span class="o">=</span> <span class="n">text_cnt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">font_width_h</span> <span class="o">+</span> <span class="n">text_cnt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">font_width</span> <span class="o">+</span> <span class="n">padding</span>
                            <span class="k">try</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">cell_widths</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">width</span><span class="p">:</span>
                                    <span class="n">cell_widths</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">width</span>
                            <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                                <span class="k">raise</span> <span class="n">e</span>
                        <span class="n">total</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="n">y</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">cell_widths</span><span class="p">:</span>
                <span class="n">worksheet</span><span class="p">.</span><span class="n">set_column</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>  <span class="c1"># Column  A   width set to 20.
</span>                <span class="n">x</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="n">writer</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<p>ìœ„ì˜ ì½”ë“œë¥¼ í†µí•´ ì—‘ì…€ íŒŒì¼ì´ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ë©´ ì•„ë˜ì˜ ì½”ë“œë¡œ S3ì— ì—…ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">s3</span><span class="p">.</span><span class="n">upload_file</span><span class="p">(</span><span class="n">folder_name</span> <span class="o">+</span> <span class="s">'/'</span> <span class="o">+</span> <span class="n">template_name</span> <span class="o">+</span> <span class="s">'.'</span> <span class="o">+</span> <span class="n">output_format</span><span class="p">,</span>
                                       <span class="n">constants</span><span class="p">.</span><span class="n">MASSIVE_EXCEL_UPLOAD_BUCKET</span><span class="p">,</span>
                                       <span class="n">constants</span><span class="p">.</span><span class="n">MASSIVE_EXCEL_UPLOAD_FOLDER</span>
                                       <span class="o">+</span> <span class="s">'/'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid_name</span><span class="p">)</span> <span class="o">+</span> <span class="s">'/'</span> <span class="o">+</span> <span class="n">template_name</span>
                                       <span class="o">+</span> <span class="s">'.'</span> <span class="o">+</span> <span class="n">output_format</span>
                                       <span class="p">,</span> <span class="n">ExtraArgs</span><span class="o">=</span><span class="p">{</span><span class="s">'ACL'</span><span class="p">:</span> <span class="s">'public-read'</span><span class="p">})</span>
</code></pre></div></div>

<p>ì´ë•Œ â€˜ACLâ€™: â€˜public-readâ€™ë¥¼ ì´ìš©í•˜ëŠ” ì´ìœ ë¡œ í´ë¼ì´ì–¸íŠ¸ê°€ í¼ë¸”ë¦­ìœ¼ë¡œ ì„¤ì •ë˜ì§€ ì•Šì€ ë²„í‚·ì— ëŒ€í•˜ì—¬ ê°ì²´ë§Œ í¼ë¸”ë¦­ìœ¼ë¡œ ì„¤ì •í•˜ì—¬ ë‹¤ìš´ë¡œë“œ ë§í¬ë¥¼ í†µí•´ ë‹¤ìš´ë¡œë“œí•  ìˆ˜ ìˆë„ë¡ í•´ì£¼ëŠ” ê²ƒì…ë‹ˆë‹¤. ì—…ë¡œë“œë¥¼ ì™„ë£Œí•˜ê³  ë‚˜ë©´ tmp í´ë”ì— data[00N].data íŒŒì¼ë“¤ê³¼ header.dataë¥¼ ì‚­ì œí•´ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ì½”ë“œ ì¼ë¶€ ë°œì·Œ
</span><span class="k">finally</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">db</span><span class="p">:</span>
            <span class="n">db</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ApiException</span><span class="p">(</span><span class="s">'VL00001'</span><span class="p">,</span> <span class="s">'ì˜ëª»ëœ ì¶”ì¶œ í¬ë§·ì…ë‹ˆë‹¤.'</span><span class="p">)</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="c1"># ì—‘ì…€ íŒŒì¼ í¬ë§·ìœ¼ë¡œ ì¶”ì¶œ ì™„ë£Œ í›„ ê¸°ì¡´ ë°ì´í„° ë° í—¤ë” íŒŒì¼ ì‚­ì œ
</span>        <span class="n">file_list</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="p">.</span><span class="n">glob</span><span class="p">(</span><span class="n">folder_name</span> <span class="o">+</span> <span class="s">'/data*'</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">getctime</span><span class="p">)</span>
        <span class="n">file_list</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">folder_name</span> <span class="o">+</span> <span class="s">'/header.data'</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">file_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">exists</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
                <span class="n">os</span><span class="p">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">'[í—¤ë” ë° ë°ì´í„° ì‚­ì œ ì²˜ë¦¬ ì™„ë£Œ]'</span><span class="p">,</span> <span class="n">log_type</span><span class="o">=</span><span class="s">'info'</span><span class="p">)</span>
</code></pre></div></div>

<p>ì´ë ‡ê²Œ ì—‘ì…€ì´ ì—…ë¡œë“œë˜ê³ , mergeëœ íŒŒì¼ì´ ì •ìƒì ìœ¼ë¡œ ì‚­ì œë˜ì—ˆë‹¤ë©´ ë©”ì¼ë¡œ ë°œì†¡í•œ ë’¤ ë§ˆë¬´ë¦¬í•´ ì£¼ë©´ ë©ë‹ˆë‹¤.
<br /><br /></p>

<h2 id="4-ì´ë©”ì¼ì„-í†µí•´-ë‹¤ìš´ë¡œë“œ-url-ë³´ë‚´ê¸°">#4. ì´ë©”ì¼ì„ í†µí•´ ë‹¤ìš´ë¡œë“œ URL ë³´ë‚´ê¸°</h2>

<p>ì§€ê¸ˆê¹Œì§€ pythonì„ ì‚¬ìš©í•˜ì—¬ ì½”ë“œë¥¼ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ AWS SES ë˜í•œ Pythonì„ ìœ„í•œ AWSì˜ SDKì¸ boto3ë¥¼ ì´ìš©í•˜ì—¬ ë©”ì¼ì„ ë°œì†¡í•  ê²ƒì…ë‹ˆë‹¤. ì•„ë˜ì™€ ê°™ì´ SESì—ì„œ SMTP ì¸ì¦ ë©”ì¼ë¡œ ì¸ì¦ì„ í•´ì•¼ SENDER, ì¦‰ ë°œì‹ ìë¡œ ë©”ì¼ì„ ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<figure class="fullwidth">
  <img src="http://labs.brandi.co.kr///assets/2020/20200609/04.png" alt="excel" />
</figure>
<figcaption></figcaption>

<p>ì•„ë˜ëŠ” ë©”ì¼ ì „ì†¡ì„ ìœ„í•œ ì½”ë“œë¥¼ ì¼ë¶€ ë°œì·Œí•œ ê²ƒì…ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">uuid</span>
<span class="kn">import</span> <span class="nn">smtplib</span>
<span class="kn">import</span> <span class="nn">email.utils</span>
<span class="kn">from</span> <span class="nn">email.mime.multipart</span> <span class="kn">import</span> <span class="n">MIMEMultipart</span>
<span class="kn">from</span> <span class="nn">email.mime.text</span> <span class="kn">import</span> <span class="n">MIMEText</span>
<span class="kn">import</span> <span class="nn">boto3</span>

<span class="c1"># ì½”ë“œ ì¼ë¶€ ë°œì·Œ
</span><span class="k">def</span> <span class="nf">__send_mail</span><span class="p">(...):</span>
        <span class="c1"># Replace sender@example.com(opens in new tab) with your "From" address.
</span>        <span class="c1"># This address must be verified.
</span>        <span class="n">sender</span> <span class="o">=</span> <span class="n">constants</span><span class="p">.</span><span class="n">SENDER</span>
        <span class="n">sender_name</span> <span class="o">=</span> <span class="n">constants</span><span class="p">.</span><span class="n">SENDER_NAME</span>
        <span class="c1"># Replace recipient@example.com(opens in new tab) with a "To" address. If your account
</span>        <span class="c1"># is still in the sandbox, this address must be verified.
</span>        <span class="n">recipient</span> <span class="o">=</span> <span class="n">mail_info</span><span class="p">[</span><span class="s">'email'</span><span class="p">]</span>
        <span class="c1"># Replace smtp_username with your Amazon SES SMTP user name.
</span>        <span class="n">username_smtp</span> <span class="o">=</span> <span class="n">constants</span><span class="p">.</span><span class="n">USERNAME_SMTP</span>
        <span class="c1"># Replace smtp_password with your Amazon SES SMTP password.
</span>        <span class="n">password_smtp</span> <span class="o">=</span> <span class="n">constants</span><span class="p">.</span><span class="n">PASSWORD_SMTP</span>
        <span class="c1"># (Optional) the name of a configuration set to use for this message.
</span>        <span class="c1"># If you comment out this line, you also need to remove or comment out
</span>        <span class="c1"># the "X-SES-CONFIGURATION-SET:" header below.
</span>        <span class="c1"># CONFIGURATION_SET = "ConfigSet"
</span>        <span class="c1"># If you're using Amazon SES in an AWS Region other than ë¯¸êµ­ ì„œë¶€(ì˜¤ë ˆê³¤),
</span>        <span class="c1"># replace email-smtp.us-west-2.amazonaws.com with the Amazon SES SMTP
</span>        <span class="c1"># endpoint in the appropriate region.
</span>        <span class="n">host</span> <span class="o">=</span> <span class="n">constants</span><span class="p">.</span><span class="n">SMTP_HOST</span>
        <span class="n">port</span> <span class="o">=</span> <span class="n">constants</span><span class="p">.</span><span class="n">SMTP_PORT</span>
        <span class="c1"># PORT = 465
</span>        <span class="c1"># The subject line of the email.
</span>            <span class="n">body_text</span> <span class="o">=</span> <span class="s">"""
ì•ˆë…•í•˜ì„¸ìš”. {0}ì…ë‹ˆë‹¤.
{1}ì— ìš”ì²­í•˜ì‹  íŒŒì¼ì„ ì•„ë˜ URLì„ í†µí•´ ë‹¤ìš´ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.
{2}
ë‹¤ìš´ë¡œë“œ ê¸°ê°„ : {3} ~ {4}

* ë³¸ ë©”ì¼ì€ ë°œì‹  ì „ìš©ìœ¼ë¡œ íšŒì‹ ì´ ë¶ˆê°€í•©ë‹ˆë‹¤.
  ë¬¸ì˜ì‚¬í•­ì€ ì¹´ì¹´ì˜¤ í”ŒëŸ¬ìŠ¤ì¹œêµ¬ @{0}ì…€ëŸ¬ë¥¼ ì´ìš©í•´ ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.
ê°ì‚¬í•©ë‹ˆë‹¤.
"""</span><span class="p">.</span><span class="nb">format</span><span class="p">(...)</span>

        <span class="c1"># Create message container - the correct MIME type is multipart/alternative.
</span>        <span class="n">msg</span> <span class="o">=</span> <span class="n">MIMEMultipart</span><span class="p">(</span><span class="s">'alternative'</span><span class="p">)</span>
        <span class="n">msg</span><span class="p">[</span><span class="s">'Subject'</span><span class="p">]</span> <span class="o">=</span> <span class="n">subject</span>
        <span class="n">msg</span><span class="p">[</span><span class="s">'From'</span><span class="p">]</span> <span class="o">=</span> <span class="n">email</span><span class="p">.</span><span class="n">utils</span><span class="p">.</span><span class="n">formataddr</span><span class="p">((</span><span class="n">sender_name</span><span class="p">,</span> <span class="n">sender</span><span class="p">))</span>
        <span class="n">msg</span><span class="p">[</span><span class="s">'To'</span><span class="p">]</span> <span class="o">=</span> <span class="n">recipient</span>
        <span class="c1"># Comment or delete the next line if you are not using a configuration set
</span>        <span class="c1"># msg.add_header('X-SES-CONFIGURATION-SET',CONFIGURATION_SET)
</span>        <span class="c1"># Record the MIME types of both parts - text/plain and text/html.
</span>        <span class="n">part1</span> <span class="o">=</span> <span class="n">MIMEText</span><span class="p">(</span><span class="n">body_text</span><span class="p">,</span> <span class="s">'plain'</span><span class="p">)</span>
        <span class="n">part2</span> <span class="o">=</span> <span class="n">MIMEText</span><span class="p">(</span><span class="n">body_html</span><span class="p">,</span> <span class="s">'html'</span><span class="p">)</span>
        <span class="c1"># Attach parts into message container.
</span>        <span class="c1"># According to RFC 2046, the last part of a multipart message, in this case
</span>        <span class="c1"># the HTML message, is best and preferred.
</span>        <span class="n">msg</span><span class="p">.</span><span class="n">attach</span><span class="p">(</span><span class="n">part1</span><span class="p">)</span>
        <span class="n">msg</span><span class="p">.</span><span class="n">attach</span><span class="p">(</span><span class="n">part2</span><span class="p">)</span>
        <span class="c1"># Try to send the message.
</span>        <span class="k">try</span><span class="p">:</span>
            <span class="n">server</span> <span class="o">=</span> <span class="n">smtplib</span><span class="p">.</span><span class="n">SMTP</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>
            <span class="n">server</span><span class="p">.</span><span class="n">ehlo</span><span class="p">()</span>
            <span class="n">server</span><span class="p">.</span><span class="n">starttls</span><span class="p">()</span>
            <span class="c1"># stmplib docs recommend calling ehlo() before &amp; after starttls()
</span>            <span class="n">server</span><span class="p">.</span><span class="n">ehlo</span><span class="p">()</span>
            <span class="n">server</span><span class="p">.</span><span class="n">login</span><span class="p">(</span><span class="n">username_smtp</span><span class="p">,</span> <span class="n">password_smtp</span><span class="p">)</span>
            <span class="n">server</span><span class="p">.</span><span class="n">sendmail</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">recipient</span><span class="p">,</span> <span class="n">msg</span><span class="p">.</span><span class="n">as_string</span><span class="p">())</span>
            <span class="n">server</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
        <span class="c1"># Display an error message if something goes wrong.
</span>        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ApiException</span><span class="p">(</span><span class="s">'VL00001'</span><span class="p">,</span> <span class="s">'ë©”ì¼ì „ì†¡ì— ì˜¤ë¥˜ê°€ ë°œìƒí•˜ì˜€ìŠµë‹ˆë‹¤.'</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># ë©”ì¼ ì „ì†¡ ì™„ë£Œì— ëŒ€í•´ì„  ë¡œê·¸ ì²˜ë¦¬
</span>            <span class="bp">self</span><span class="p">.</span><span class="n">_logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">'[ë©”ì¼ ì „ì†¡ ì™„ë£Œ]'</span><span class="p">,</span> <span class="n">log_type</span><span class="o">=</span><span class="s">'info'</span><span class="p">)</span>
</code></pre></div></div>

<p>ìœ„ì™€ ê°™ì´ ë©”ì¼ì„ ë³´ë‚´ì£¼ëŠ” ì½”ë“œê°€ ì„±ê³µì ìœ¼ë¡œ ì‹¤í–‰ë˜ë©´, ìˆ˜ì‹ ìëŠ” ì•„ë˜ì™€ ê°™ì´ ë©”ì¼ì„ ë°›ê²Œ ë©ë‹ˆë‹¤.</p>

<figure class="percent80">
  <img src="http://labs.brandi.co.kr///assets/2020/20200609/05.png" alt="excel" />
</figure>
<figcaption></figcaption>

<p>ì´ë ‡ê²Œ ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ì—‘ì…€ ë‹¤ìš´ë¡œë“œ ìš”ì²­ë¶€í„° ë©”ì¼ì„ ìˆ˜ì‹ í•˜ëŠ” ê²ƒê¹Œì§€ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤.
<br /><br /></p>

<h2 id="conclusion">Conclusion</h2>

<p>ì´ë¡œì¨ ëŒ€ìš©ëŸ‰ ì—‘ì…€ ë‹¤ìš´ë¡œë“œ ë¬¸ì œë¥¼ í•´ê²°í–ˆì§€ë§Œ, ëª‡ ê°€ì§€ì˜ ê³ ë¯¼ê±°ë¦¬ëŠ” ì”ì¬í•©ë‹ˆë‹¤.</p>

<ul>
  <li>ë™ì‹œì„±ì´ 1ë¡œ ì œí•œë˜ì–´ ìˆì–´, ë‹¤ìˆ˜ì˜ ì…€ëŸ¬ í˜¹ì€ ê´€ë¦¬ìê°€ ë™ì‹œì— ëŒ€ìš©ëŸ‰ ì—‘ì…€ ë‹¤ìš´ë¡œë“œ ìš”ì²­ì„ ë³´ë‚´ëŠ” ê²½ìš°ì˜ ëŒ€ê¸° ì‹œê°„.</li>
  <li>ì•½ ë°±ë§Œ ê±´ì´ ë„˜ì–´ê°€ëŠ” ë°ì´í„°ë¥¼ ì—‘ì…€ ë‹¤ìš´ë¡œë“œ í•´ì•¼ í•˜ëŠ” ê²½ìš°</li>
</ul>

<p>ì²« ë²ˆì§¸ ë¬¸ì œì— ëŒ€í•´ì„œëŠ” replica ì„œë²„ë¥¼ ì´ìš©í•˜ì—¬ ë™ì‹œì„±ì„ ëŠ˜ë¦° ë’¤ ë‹¤ì–‘í•œ ëŒë‹¤ë¥¼ ë™ì‹œì— êµ¬ë™ì‹œí‚¬ ìˆ˜ ìˆë„ë¡ ì§€ì†ì ìœ¼ë¡œ ê²€í†  ì¤‘ì— ìˆìŠµë‹ˆë‹¤. í•¨ê»˜, ë‘ ë²ˆì§¸ ë¬¸ì œì— ëŒ€í•´ì„œëŠ” íŒŒì›Œí”¼ë²— í˜¹ì€ ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”ì„ ì´ìš©í•˜ëŠ” ë“± ë‹¤ì–‘í•œ ê³ ë¯¼ì„ ì§€ì†í•´ì•¼ í•©ë‹ˆë‹¤. ë¿ë§Œ ì•„ë‹ˆë¼ ë‹¤ê±´ì˜ ë°ì´í„°ë¥¼ ë‚´ë ¤ë°›ëŠ” ê²½ìš°ì˜ latency ë“± ì—¬ì „íˆ í’€ì–´ì•¼ í•  ìˆ™ì œê°€ ë§ì´ ë‚¨ì•„ìˆìŠµë‹ˆë‹¤.</p>
:ET